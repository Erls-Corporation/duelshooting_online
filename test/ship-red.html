<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Duel Shooting</title>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">google.load('prototype', '1.7')</script>


<script type="text/javascript" src="/js/game/game.js"></script>

<script type="text/javascript" src="/js/action/base/action.js"></script>
<script type="text/javascript" src="/js/action/action-ship-red.js"></script>

<script type="text/javascript" src="/js/command/base/command.js"></script>
<script type="text/javascript" src="/js/command/command-ship-red.js"></script>

<script type="text/javascript" src="/js/sound/sound-creater.js"></script>
<script type="text/javascript" src="/js/auto/automatic-controls.js"></script>

<script type="text/javascript" src="/js/sprite/base/sprite.js"></script>
<script type="text/javascript" src="/js/sprite/background.js"></script>
<script type="text/javascript" src="/js/sprite/bullet.js"></script>
<script type="text/javascript" src="/js/sprite/bullet-homing.js"></script>
<script type="text/javascript" src="/js/sprite/funnel.js"></script>
<script type="text/javascript" src="/js/sprite/funnel-circle.js"></script>
<script type="text/javascript" src="/js/sprite/funnel-defence-left.js"></script>
<script type="text/javascript" src="/js/sprite/funnel-defence-right.js"></script>
<script type="text/javascript" src="/js/sprite/i-field.js"></script>

<script type="text/javascript" src="/js/sprite/ship.js"></script>
<script type="text/javascript" src="/js/sprite/ship-white.js"></script>
<script type="text/javascript" src="/js/sprite/ship-red.js"></script>
<script type="text/javascript" src="/js/sprite/ship-afterimage.js"></script>

<script type="text/javascript" src="/socket.io/socket.io.js"></script>
<script type="text/javascript">
Event.observe(window, 'load', function () {

    var isEnemy = false;
    var ship = new ShipRed(isEnemy);
    var enemy = new ShipWhite(!isEnemy);
    var bg = new Background();

    sound = new SoundCreater();
    var hitSE = sound.createAudio('/se/hit.mp3');
    var loseSE = sound.createAudio('/se/lose.mp3');
    var newtypeSE = sound.createAudio('/se/newtype.mp3');

    ship.setSoundHit(hitSE);
    ship.setSoundLose(loseSE);
    ship.setSoundNewtype(newtypeSE);

    enemy.setSoundHit(hitSE);
    enemy.setSoundLose(loseSE);

    var auto = new AutomaticControls(ship, enemy, isEnemy);
    auto.setSoundAttack(sound.createAudio('/se/attack.mp3'));
    auto.setSoundMegaCannon(sound.createAudio('/se/mega.mp3'));
    auto.setSoundFunnelGo(sound.createAudio('/se/funnel1.mp3'));
    auto.setSoundFunnelAttack(sound.createAudio('/se/funnel2.mp3'));

    var action = new ActionShipRed();
    var command = new CommandShipRed(ship, auto);
    var game = new Game(function() {
        command.execute(action.getCommand());
        auto.move();
        ship.getIField().move();
    });
    
    bg.renderElement();
    ship.renderElement();
    enemy.renderElement();

    game.start();



    var socket = io.connect('http://localhost:3000');
    socket.emit('news', {message: 'Hello World from client'});
    socket.on('news', function(data) {
        console.log(data);
    });
});
</script>
</head>
<body>
</body>
</html>
